<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Intraday Agentic Liquidity Cockpit</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="ui/styles.css"/>
</head>
<body>

<header class="topbar">
  <div>
    <div class="title">Intraday Agentic Liquidity Cockpit</div>
    <div class="subtitle">
      Early-warning radar • Forecast curve • Agent playbooks • Approvals • Audit
      <span class="dot">•</span>
      <span id="lastRef">Last refresh: —</span>
    </div>
  </div>

  <div class="right">
    <div class="pill" id="statusPill">—</div>
    <button class="btn" id="btnTour">Demo tour</button>
  </div>
</header>

<!-- Executive strip -->
<section class="execstrip">
  <div class="exec card">
    <div class="execLabel">Portfolio status</div>
    <div class="execValue" id="execStatus">—</div>
  </div>
  <div class="exec card">
    <div class="execLabel">Worst minutes-to-breach</div>
    <div class="execValue" id="execWorstMTB">—</div>
  </div>
  <div class="exec card">
    <div class="execLabel">Entities in early warning</div>
    <div class="execValue" id="execWarnCount">—</div>
  </div>
  <div class="exec card">
    <div class="execLabel">Entities imminent</div>
    <div class="execValue" id="execBreachCount">—</div>
  </div>
</section>

<!-- Controls -->
<section class="controls card">
  <div class="row">
    <div class="field">
      <label>Scenario</label>
      <input id="scenarioId" value="DELAYED_INFLOW_DEMO"/>
    </div>

    <div class="field">
      <label>Seed</label>
      <input id="seed" value="42"/>
    </div>

    <div class="field">
      <label>Entity</label>
      <select id="entity">
        <option value="E1">E1</option>
        <option value="E2">E2</option>
        <option value="E3">E3</option>
      </select>
    </div>

    <div class="field">
      <label>Currency</label>
      <select id="currency">
        <option>USD</option>
        <option>EUR</option>
      </select>
    </div>

    <div class="btns">
      <button id="btnStart" class="btn primary">Start</button>
      <button id="btnRun" class="btn primary">Assess + Recommend</button>
      <button id="btnReset" class="btn danger">Reset</button>
    </div>
  </div>

  <!-- Timeline / playback -->
  <div class="row playback">
    <div class="btns">
      <button class="btn" id="btnStep">Step +</button>
      <select id="stepSize">
        <option value="5">5 min</option>
        <option value="10">10 min</option>
        <option value="15">15 min</option>
      </select>

      <button class="btn" id="btnPlay">Play</button>
      <button class="btn" id="btnPause">Pause</button>

      <label class="tinyLabel">Speed</label>
      <select id="playSpeed">
        <option value="2000">1x</option>
        <option value="1200">1.5x</option>
        <option value="800">2.5x</option>
        <option value="500">4x</option>
      </select>
    </div>

    <div class="toggle">
      <input type="checkbox" id="autoagent"/>
      <label for="autoagent">Auto-run agent on warnings</label>
    </div>

    <div class="spacer"></div>

    <div class="field small">
      <label>Warning threshold (min)</label>
      <input id="warnMins" value="60"/>
    </div>

    <div class="field small">
      <label>Breach threshold (min)</label>
      <input id="breachMins" value="30"/>
    </div>
  </div>
</section>

<!-- Portfolio overview -->
<section class="portfolio card">
  <div class="card-title">Portfolio Overview (Entities × Currencies)</div>
  <div class="hint">Click any tile to focus the main view on that entity + currency.</div>
  <div id="portfolioGrid" class="portfolioGrid"></div>
</section>

<!-- Main grid -->
<section class="grid">
  <div class="card">
    <div class="card-title">Forecast & Buffer</div>
    <canvas id="chart" height="120"></canvas>

    <div class="kpis">
      <div class="kpi">
        <div class="kpi-label">Current Balance</div>
        <div class="kpi-value" id="kpiBalance">—</div>
      </div>
      <div class="kpi">
        <div class="kpi-label">Early Warning Buffer</div>
        <div class="kpi-value" id="kpiBuffer">—</div>
      </div>
      <div class="kpi">
        <div class="kpi-label">Buffer Remaining</div>
        <div class="kpi-value" id="kpiRemaining">—</div>
      </div>
      <div class="kpi">
        <div class="kpi-label">Minutes to Breach</div>
        <div class="kpi-value" id="kpiMTB">—</div>
      </div>
    </div>

    <div class="card-title">Drivers (Top 8)</div>
    <table class="tbl" id="driversTbl">
      <thead>
        <tr><th>Time</th><th>Dir</th><th>Amt</th><th>Rail</th><th>Status</th><th>Priority</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="stack">
    <div class="card">
      <div class="card-title">Alerts</div>
      <div id="alerts" class="alerts"></div>
    </div>

    <div class="card">
      <div class="card-title">Agent Recommendations</div>
      <div id="recs"></div>

      <div class="card-title">Approval</div>
      <div class="row">
        <div class="field">
          <label>Selected action</label>
          <input id="selectedAction" placeholder="click an action below" readonly/>
        </div>
        <div class="btns">
          <button class="btn primary" id="btnApprove">Approve</button>
          <button class="btn" id="btnReject">Reject</button>
        </div>
      </div>
      <pre id="approvalResp" class="pre"></pre>
    </div>

    <div class="card">
      <div class="card-title">Config</div>
      <div class="row">
        <div class="field">
          <label>SIMULATOR_URL</label>
          <input id="simUrl"/>
        </div>
        <div class="field">
          <label>RISK_ENGINE_URL</label>
          <input id="riskUrl"/>
        </div>
        <div class="field">
          <label>ORCHESTRATOR_URL</label>
          <input id="orchUrl"/>
        </div>
      </div>
      <div class="hint">Auto-filled from config.js (editable for demos).</div>
    </div>
  </div>
</section>

<script src="config.js"></script>
<script src="app.js"></script>
</body>
</html>
